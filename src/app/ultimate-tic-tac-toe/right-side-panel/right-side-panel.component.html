<div class="settings-panel" [class.collapsed]="!settings.isSettingsVisible"
     [class.moves-tab-active]="activeTab === 'moves'">


<!--  <button class="toggle-btn" (click)="toggleSettings()" aria-label="Toggle settings">&times;</button>-->

  <top-eval-panel></top-eval-panel>

  <div class="content-wrapper">

    <div class="tabs">
      <button [class.active]="activeTab === 'moves'" (click)="setTab('moves')">
        <mat-icon style="margin-bottom: -7px; font-size: 20px;">description</mat-icon>
        Moves
      </button>
      <button [class.active]="activeTab === 'settings'" (click)="setTab('settings')">
        <mat-icon style="margin-bottom: -7px; font-size: 20px;">tune</mat-icon>
        Settings
      </button>
    </div>

    <!-- Moves Tab Content -->
    <div *ngIf="activeTab === 'moves'" class="moves-tab tab-content">
      <div class="table-wrapper">
        <table class="moves-table">
          <thead>
          <tr>
            <th class="move-number-header">#</th>
            <th>Cross</th>
            <th>Circle</th>
          </tr>
          </thead>
        </table>
        <div class="table-body-wrapper" #scrollContainer>
          <table class="moves-table">
            <tbody>
            <tr *ngFor="let i of maxMovesArray()">
              <td class="move-number-cell"><strong>{{ i + 1 }}.</strong></td>
              <td>
              <span *ngIf="player1Moves[i]">
                <span class="coord"
                      [ngClass]="{ 'bold': isCurrentMove(true, i) }"
                      (click)="onMoveClick(i, 'player1')"
                      style="cursor: pointer;">
                  {{ player1Moves[i] }}
                </span>
              </span>
              </td>
              <td>
              <span *ngIf="player2Moves[i]">
                 <span class="coord"
                       [ngClass]="{ 'bold': isCurrentMove(false, i) }"
                       (click)="onMoveClick(i, 'player2')"
                       style="cursor: pointer;">
                  {{ player2Moves[i] }}
                </span>
              </span>
              </td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="lower-panel" *ngIf="activeTab === 'moves'">
      <chart-panel></chart-panel>

      <div class="button-row">

        <button (click)="onGoToStart()" class="change-move-btn"
                aria-label="Undo-Start" [disabled]="currentMove <= 0">
          <i class="bi bi-skip-start-fill"></i>
        </button>

        <button matTooltip="You can also press left arrow to undo last move." (click)="onUndo()" class="change-move-btn"
                aria-label="Undo" [disabled]="currentMove <= 0" >
          <i class="bi bi-chevron-left"></i>
        </button>

        <button matTooltip="You can also press 'n' to start new game." (click)="onClearBoard()" class="clear-btn"
                aria-label="New game">
          New game
        </button>

        <button matTooltip="You can also press right arrow to go to next move." (click)="onNext()" class="change-move-btn"
                aria-label="Next" [disabled]="currentMove + 1 > moves.length">
          <i class="bi bi-chevron-right"></i>
        </button>

        <button (click)="onGoToEnd()" class="change-move-btn"
                aria-label="Next-End" [disabled]="currentMove + 1 > moves.length">
          <i class="bi bi-skip-end-fill"></i>
        </button>
      </div>
    </div>

    <!-- Settings Tab Content -->
    <div *ngIf="activeTab === 'settings'" class="settings-tab tab-content">
      <h3>Engine Settings</h3>

      <label for="thinkingTime" style="margin-bottom:-5px; display:block;">
        Thinking Time (ms): {{settings.thinkingTime}}
      </label>
      <input
        id="thinkingTime"
        type="range"
        min="100"
        max="1000"
        step="100"
        [(ngModel)]="settings.thinkingTime"
        (input)="onSettingsChange()"
        style="margin-top:2px; display:block;"
      />

      <label>
        <input type="checkbox" [(ngModel)]="settings.showEval" (ngModelChange)="onSettingsChange()"
               style="margin-top:15px"/> Show Eval
      </label>

      <label>
        <input type="checkbox" [(ngModel)]="settings.showVisits" (ngModelChange)="onSettingsChange()"/> Show Visits
      </label>

      <label>
        <input type="checkbox" [(ngModel)]="settings.playVsAi" (ngModelChange)="onSettingsChange()"/> AI moves
        automatically
      </label>
    </div>
  </div>
</div>
